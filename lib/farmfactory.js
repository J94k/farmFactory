var farmFactory=function(){"use strict";n=t={exports:{}},n.exports=e;function e(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?n.exports=e=function(t){return typeof t}:n.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}var n;var t,a=function(){return(a=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function o(i,r,s,u){return new(s=s||Promise)(function(t,e){function n(t){try{o(u.next(t))}catch(t){e(t)}}function a(t){try{o(u.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(n,a)}o((u=u.apply(i,r||[])).next())})}function l(n,a){var o,i,r,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(r=2&e[0]?i.return:e[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,e[1])).done)return r;switch(i=0,r&&(e=[2&e[0],r.value]),e[0]){case 0:case 1:r=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,i=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!r||e[1]>r[0]&&e[1]<r[3])){s.label=e[1];break}if(6===e[0]&&s.label<r[1]){s.label=r[1],r=e;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(e);break}r[2]&&s.ops.pop(),s.trys.pop();continue}e=a.call(n,s)}catch(t){e=[6,t],i=0}finally{o=r=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(t){y=a(a({},y),t)}var i,p=function(t){var t='\n    <div class="farmfactory-overlay" id="">\n      <div class="farmfactory-modal">\n        <button class="farmfactory-closeButton">\n          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 32 32">\n            <path stroke="currentColor" stroke-width="2" d="M9 9l7 6.99L23 9l-6.99 7L23 23l-7-6.99L9 23l6.99-7L9 9z" opacity=".9"/>\n          </svg>\n        </button>\n        <div class="farmfactory-inner">\n          <div>'+t+'</div>\n        </div>\n        <div class="farmfactory-footer">\n          <button class="farmfactory-button gray">Close</button>\n        </div>\n      </div>\n    </div>\n  ',e=document.createElement("div");e.innerHTML=t,document.body.appendChild(e),e.querySelector(".farmfactory-closeButton").addEventListener("click",function(){e.remove()}),e.querySelector(".farmfactory-button").addEventListener("click",function(){e.remove()})},y={opts:null,web3:null,web3Modal:null,provider:null,account:null,contracts:null,stakingTokenName:"",stakingDecimals:null,rewardsTokenName:"",rewardsDecimals:null},s=function(){i&&(i.remove(),i=null)},u={open:function(){var t='\n    <div class="farmfactory-overlay">\n      <div class="farmfactory-modal">\n        <button class="farmfactory-closeButton">\n          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 32 32">\n            <path stroke="currentColor" stroke-width="2" d="M9 9l7 6.99L23 9l-6.99 7L23 23l-7-6.99L9 23l6.99-7L9 9z" opacity=".9"/>\n          </svg>\n        </button>\n        <div class="farmfactory-inner">\n          Please open your wallet and change network to <b>'+y.opts.widget.networkName+"</b>.\n        </div>\n      </div>\n    </div>\n  ";(i=document.createElement("div")).innerHTML=t,document.body.appendChild(i),i.querySelector(".farmfactory-closeButton").addEventListener("click",s)},close:s},c={farm:[{inputs:[{internalType:"address",name:"_rewardsToken",type:"address"},{internalType:"address",name:"_stakingToken",type:"address"},{internalType:"uint256",name:"_rewardsDuration",type:"uint256"},{internalType:"uint256",name:"_stakingTokensDecimal",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Recovered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"reward",type:"uint256"}],name:"RewardAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"reward",type:"uint256"}],name:"RewardPaid",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"newDuration",type:"uint256"}],name:"RewardsDurationUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Staked",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Withdrawn",type:"event"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"earned",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"exit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getReward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getRewardForDuration",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"lastTimeRewardApplicable",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"lastUpdateTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"a",type:"uint256"},{internalType:"uint256",name:"b",type:"uint256"}],name:"min",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"uint256",name:"reward",type:"uint256"}],name:"notifyRewardAmount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"periodFinish",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"n",type:"uint256"},{internalType:"uint256",name:"e",type:"uint256"}],name:"pow",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"uint256",name:"tokenAmount",type:"uint256"}],name:"recoverERC20",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"rewardPerToken",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"rewardPerTokenStored",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"rewardRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"rewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"rewardsDuration",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"rewardsToken",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_rewardsDuration",type:"uint256"}],name:"setRewardsDuration",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"stake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"stakingToken",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"stakingTokensDecimalRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"userRewardPerTokenPaid",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"}],rewards:[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"},{name:"_extraData",type:"string"}],name:"approveAndCall",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"mint",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"value",type:"uint256"}],name:"burn",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"from",type:"address"}],name:"getAvailableBalance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"tokensMinted",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"from",type:"address"},{name:"value",type:"uint256"}],name:"burnFrom",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"account",type:"address"}],name:"addMinter",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[],name:"renounceMinter",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"account",type:"address"}],name:"isMinter",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"freezeFor",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"}],name:"freezeOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"},{name:"_unfreezeTimestamp",type:"uint256"},{name:"_subsequentUnlock",type:"bool"}],name:"mintWithFreeze",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"maxSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"MinterAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"}],name:"MinterRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"}]};c.staking=c.rewards;function d(t){var e=y.opts,n=y.web3,e=e.widget[t+"Address"],t=c[t];return new n.eth.Contract(t,e)}function m(){return Promise.all([d("farm"),d("rewards"),d("staking")]).then(function(t){return{farm:t[0],rewards:t[1],staking:t[2]}})}var f=(v.prototype.addHandler=function(t){var e=this;this.handlers.push(t.bind({unsubscribe:function(){e.removeHandler(t)}}))},v.prototype.removeHandler=function(t){t=this.handlers.indexOf(t);this.handlers.splice(t,1)},v.prototype.call=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.handlers.forEach(function(t){try{t.apply(void 0,e)}catch(t){console.error(t)}})},v);function v(t){this.name=t,this.handlers=[]}function w(){this.events={}}function b(){return o(void 0,void 0,void 0,function(){var a,e,n;return l(this,function(t){switch(t.label){case 0:return e=y.opts,[4,(a=y.web3).eth.getChainId()];case 1:return n=t.sent(),n={1:"mainnet",3:"ropsten",4:"rinkeby",42:"kovan",56:"bsc",97:"bsc_test"}[n],console.log("active network name:",n),u.close(),n&&n.toLowerCase()===e.widget.networkName.toLowerCase()?[4,a.eth.getAccounts()]:(u.open(),[2]);case 2:return(n=t.sent(),console.log("accounts:",n),e=n[0],r({account:e}),e)?(console.log("selected account:",e),n=n.map(function(n){return o(void 0,void 0,void 0,function(){var e;return l(this,function(t){switch(t.label){case 0:return[4,a.eth.getBalance(n)];case 1:return e=t.sent(),e=a.utils.fromWei(e,"ether"),e=parseFloat(e).toFixed(4),console.log("address:",n),console.log("balance:",e),[2]}})})}),[4,Promise.all(n)]):(x(),[2]);case 3:return t.sent(),console.log("connection finalized"),L.dispatch("connect"),[2]}})})}function h(){return o(void 0,void 0,void 0,function(){var a,e,n;return l(this,function(t){switch(t.label){case 0:return e=y.opts,[4,(a=y.web3).eth.getChainId()];case 1:return n=t.sent(),n={1:"mainnet",3:"ropsten",4:"rinkeby",42:"kovan",56:"bsc",97:"bsc_test"}[n],console.log("active network name:",n),u.close(),n&&n.toLowerCase()===e.widget.networkName.toLowerCase()?[4,a.eth.getAccounts()]:(u.open(),[2]);case 2:return(n=t.sent(),console.log("accounts:",n),e=n[0],r({account:e}),e)?(console.log("selected account:",e),n=n.map(function(n){return o(void 0,void 0,void 0,function(){var e;return l(this,function(t){switch(t.label){case 0:return[4,a.eth.getBalance(n)];case 1:return e=t.sent(),e=a.utils.fromWei(e,"ether"),e=parseFloat(e).toFixed(4),console.log("address:",n),console.log("balance:",e),[2]}})})}),[4,Promise.all(n)]):(H(),[2]);case 3:return t.sent(),console.log("connection finalized"),L.dispatch("connect"),[2]}})})}function g(t){return'<div class="farmfactory-loader'+(t?" black":"")+'"><div></div><div></div><div></div></div>'}function T(t){if(!t)return t;var e=Number(t).toFixed(5);return"0.00000"===e&&(e=Number(t).toFixed(8)),"0.00000000"===e?t:e}function M(t,e){return new window.BigNumber(t).times(new window.BigNumber(10).pow(e)).toString(10)}function B(){return o(void 0,void 0,void 0,function(){var e,n,a,o,i,r,s,u,c,d;return l(this,function(t){switch(t.label){case 0:if(u=y.opts,r=y.contracts,s=y.account,e=y.stakingTokenName,n=y.stakingDecimals,a=y.rewardsTokenName,o=y.rewardsDecimals,!r)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Promise.all([r.farm.methods.balanceOf(s).call(),r.farm.methods.earned(s).call(),r.staking.methods.allowance(s,u.widget.farmAddress).call()])];case 2:return c=t.sent(),i=c[0],r=c[1],d=c[2],X(0<Number(d)),s=document.getElementById(C.widget.staked),u=document.getElementById(C.widget.earned),c=document.getElementById(C.widget.harvestButton),d=document.getElementById(C.widget.withdrawButton),s.innerText=T(i/Math.pow(10,n))+" "+e,u.innerText=T(r/Math.pow(10,o))+" "+a,c&&(0<r?c.classList.remove("disabled"):c.classList.add("disabled")),d&&(0<i?d.classList.remove("disabled"):d.classList.add("disabled")),[3,4];case 3:return d=t.sent(),console.error(d),p(d.message),[3,4];case 4:return[2]}})})}function k(){document.getElementById(C.widget.approveButton).addEventListener("click",function(){o(void 0,void 0,void 0,function(){var e,n,a,o;return l(this,function(t){switch(t.label){case 0:if(n=y.opts,a=y.web3,e=y.contracts,o=y.account,G)return[2];if(!o)return[2];if(!e.staking)return p("Staking contract is not connected"),[2];t.label=1;case 1:return t.trys.push([1,3,4,5]),G=!0,document.getElementById(C.widget.approveButton).innerHTML="Approve "+g(),n=n.widget.farmAddress,a=a.utils.toBN("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),[4,e.staking.methods.approve(n,a).send({from:o})];case 2:return t.sent().status&&p("Transaction confirmed!"),B(),[3,5];case 3:return o=t.sent(),console.error(o),p(o.message),[3,5];case 4:return G=!1,document.getElementById(C.widget.approveButton).innerHTML="Approve",[7];case 5:return[2]}})})})}function E(){var t=y.opts,e=document.getElementById(C.widget.harvestButton);t.widget.harvestButtonTitle&&(e.innerText=t.widget.harvestButtonTitle),e.addEventListener("click",function(){e.classList.contains("disabled")||o(void 0,void 0,void 0,function(){var e,n,a;return l(this,function(t){switch(t.label){case 0:if(e=y.contracts,a=y.account,G)return[2];if(!a)return[2];if(!e.farm)return p("Farm contract is not connected"),[2];n=document.getElementById(C.widget.harvestButton),t.label=1;case 1:return t.trys.push([1,3,4,5]),G=!0,n.innerHTML="Harvest "+g(),[4,e.farm.methods.getReward().send({from:a})];case 2:return t.sent().status&&p("Transaction confirmed!"),B(),[3,5];case 3:return a=t.sent(),console.error(a),p(a.message),[3,5];case 4:return G=!1,n.innerHTML="Harvest",[7];case 5:return[2]}})})})}var L=new(w.prototype.getEvent=function(t){var e=this.events[t];return e||(e=new f(t),this.events[t]=e),e},w.prototype.subscribe=function(t,e){t=this.getEvent(t);return t.addHandler(e),{event:t,handler:e}},w.prototype.unsubscribe=function(t,e){this.getEvent(t).removeHandler(e)},w.prototype.dispatch=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t=this.getEvent(t);t&&t.call.apply(t,e)},w.prototype.once=function(t,n){var a=this.getEvent(t),o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.apply(void 0,t)&&a.removeHandler(o)};return a.addHandler(o),{event:a,handlerWrapper:o}},w),x=function(){return o(void 0,void 0,void 0,function(){var e,n;return l(this,function(t){switch(t.label){case 0:return e=y.web3Modal,n=y.provider,console.log("Killing the wallet connection",n),n.close?[4,n.close()]:[3,2];case 1:t.sent(),r({provider:null}),t.label=2;case 2:return[4,e.clearCachedProvider()];case 3:return t.sent(),r({account:null}),console.log("finalize disconnect"),[2]}})})},F=function(){var t=y.opts,t=new window.Web3Modal.default({cacheProvider:!0,providerOptions:(null===(t=t.wallet)||void 0===t?void 0:t.providerOptions)||{},disableInjectedProvider:!1});return r({web3Modal:t}),(window.web3Modal=t).on("connect",function(t){return o(void 0,void 0,void 0,function(){return l(this,function(t){return console.log("web3Modal connected"),[2]})})}),t.on("disconnect",function(){return o(void 0,void 0,void 0,function(){return l(this,function(t){return console.log("web3Modal disconnected"),[2]})})}),t.on("error",function(t){console.log("web3Modal error:",t)}),t},I=function(){return o(void 0,void 0,void 0,function(){var e,n,a;return l(this,function(t){switch(t.label){case 0:e=y.web3Modal,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,e.connect()];case 2:return(a=t.sent(),r({provider:a}),window.Web3)?(n=new window.Web3(a),r({web3:n}),[4,m()]):(p("Web3 required"),[2]);case 3:return n=t.sent(),r({contracts:n}),a.on("accountsChanged",function(t){console.log("account changed",t),b()}),a.on("chainChanged",function(t){console.log("chain changed",t),b()}),a.on("networkChanged",function(t){console.log("network changed",t),b()}),[4,o(void 0,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,b()];case 1:return t.sent(),[2]}})})];case 4:return t.sent(),[3,6];case 5:return a=t.sent(),console.error(a),[3,6];case 6:return[2]}})})},C={timerRoot:"farmfactory-timer-root",widgetRoot:"farmfactory-widget-root",modalsRoot:"farmfactory-modals-root",infoModalRoot:"farmfactory-info-modal-root",widget:{root:"farmfactory-widget",earned:"farmfactory-widget-earned",staked:"farmfactory-widget-staked",lpsButtons:"farmfactory-widget-lps-buttons",harvestButton:"farmfactory-widget-harvest-button",approveButton:"farmfactory-widget-approve-button",depositButton:"farmfactory-widget-deposit-button",withdrawButton:"farmfactory-widget-withdraw-button"},connectForm:{connectButton:"farmfactory-connect-connect-button"},depositForm:{title:"farmfactory-deposit-title",input:"farmfactory-deposit-input",cancelButton:"farmfactory-deposit-cancel-button",depositButton:"farmfactory-deposit-deposit-button"},withdrawForm:{title:"farmfactory-withdraw-title",input:"farmfactory-withdraw-input",cancelButton:"farmfactory-withdraw-cancel-button",withdrawButton:"farmfactory-withdraw-deposit-button"},infoModal:{closeButton:"farmfactory-info-modal-close-button",cancelButton:"farmfactory-info-modal-cancel-button"},wrongNetworkModal:{closeButton:"farmfactory-wrong-network-modal-close-button"}},H=function(){return o(void 0,void 0,void 0,function(){var e,n;return l(this,function(t){switch(t.label){case 0:return e=y.web3Modal,n=y.provider,console.log("Killing the wallet connection",n),n.close?[4,n.close()]:[3,2];case 1:t.sent(),r({provider:null}),t.label=2;case 2:return[4,e.clearCachedProvider()];case 3:return t.sent(),r({account:null}),console.log("finalize disconnect"),[2]}})})},A=function(){return o(void 0,void 0,void 0,function(){var e,n,a;return l(this,function(t){switch(t.label){case 0:e=y.web3Modal,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,e.connect()];case 2:return(a=t.sent(),r({provider:a}),window.Web3)?(n=new window.Web3(a),r({web3:n}),[4,m()]):(p("Web3 required"),[2]);case 3:return n=t.sent(),r({contracts:n}),a.on("accountsChanged",function(t){console.log("account changed",t),h()}),a.on("chainChanged",function(t){console.log("chain changed",t),h()}),a.on("networkChanged",function(t){console.log("network changed",t),h()}),[4,o(void 0,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,h()];case 1:return t.sent(),[2]}})})];case 4:return t.sent(),[3,6];case 5:return a=t.sent(),console.error(a),[3,6];case 6:return[2]}})})},N='\n  <div class="farmfactory-form farmfactory-connect">\n    Connect wallet to enable widget.\n    <div class="farmfactory-row">\n      <button class="farmfactory-button" id="'+C.connectForm.connectButton+'">Connect</button>\n    </div>\n  </div>\n',D=function(){document.getElementById(C.widget.root).classList.remove("farmfactory-connect-visible")},R=function(){document.getElementById(C.connectForm.connectButton).addEventListener("click",A),L.subscribe("connect",D)},P='\n  <div class="farmfactory-form farmfactory-deposit">\n    <div class="farmfactory-title" id="'+C.depositForm.title+'"></div>\n    <input class="farmfactory-input" id="'+C.depositForm.input+'" type="number" value="" />\n    <div class="farmfactory-row">\n      <button class="farmfactory-button" id="'+C.depositForm.cancelButton+'">Cancel</button>\n      <button class="farmfactory-button" id="'+C.depositForm.depositButton+'">Deposit</button>\n    </div>\n  </div>\n',O=!1,S=function(){document.getElementById(C.widget.root).classList.remove("farmfactory-deposit-visible")},W=function(){var t=document.getElementById(C.depositForm.cancelButton),e=document.getElementById(C.depositForm.depositButton);t.addEventListener("click",function(){t.classList.contains("disabled")||S()}),e.addEventListener("click",function(){o(void 0,void 0,void 0,function(){var e,n,a,o,i,r;return l(this,function(t){switch(t.label){case 0:if(y.web3,e=y.contracts,r=y.account,i=y.stakingDecimals,O)return[2];if(!e.farm)return p("Farm contract is not connected"),[2];if(o=document.getElementById(C.depositForm.input),n=document.getElementById(C.depositForm.cancelButton),a=document.getElementById(C.depositForm.depositButton),!(0<(o=Number(o.value))))return[3,5];t.label=1;case 1:return t.trys.push([1,3,4,5]),O=!0,n.classList.add("disabled"),a.innerHTML="Deposit "+g(),i=M(o,i),[4,e.farm.methods.stake(i).send({from:r})];case 2:return t.sent().status&&p("Transaction confirmed!"),S(),L.dispatch("deposit success"),[3,5];case 3:return r=t.sent(),console.error(r),"INVALID_ARGUMENT"==r.code?p("Placeholder cannot be empty"):p(r.message),[3,5];case 4:return O=!1,n.classList.remove("disabled"),a.innerHTML="Deposit",[7];case 5:return[2]}})})})},_=function(){return o(void 0,void 0,void 0,function(){var e,n,a,o,i,r;return l(this,function(t){switch(t.label){case 0:return e=y.contracts,r=y.account,n=y.stakingTokenName,a=y.stakingDecimals,o=document.getElementById(C.widget.root),i=document.getElementById(C.depositForm.title),o.classList.add("farmfactory-deposit-visible"),i.innerHTML="Balance: "+g(!0),[4,e.staking.methods.balanceOf(r).call()];case 1:return r=t.sent(),i.innerHTML="Balance: <b>"+T(Number(r)/Math.pow(10,a))+" "+n+"</b>",[2]}})})},z='\n  <div class="farmfactory-form farmfactory-withdraw">\n    <div class="farmfactory-title" id="'+C.withdrawForm.title+'"></div>\n    <input class="farmfactory-input" id="'+C.withdrawForm.input+'" type="number" value="" />\n    <div class="farmfactory-row">\n      <button class="farmfactory-button" id="'+C.withdrawForm.cancelButton+'">Cancel</button>\n      <button class="farmfactory-button" id="'+C.withdrawForm.withdrawButton+'">Withdraw</button>\n    </div>\n  </div>\n',q=!1,U=function(){document.getElementById(C.widget.root).classList.remove("farmfactory-withdraw-visible")},V=function(){var t=document.getElementById(C.withdrawForm.cancelButton),e=document.getElementById(C.withdrawForm.withdrawButton);t.addEventListener("click",function(){t.classList.contains("disabled")||U()}),e.addEventListener("click",function(){o(void 0,void 0,void 0,function(){var e,n,a,o,i,r;return l(this,function(t){switch(t.label){case 0:if(y.web3,e=y.contracts,r=y.account,i=y.rewardsDecimals,q)return[2];if(!e.farm)return p("Farm contract is not connected"),[2];if(o=document.getElementById(C.withdrawForm.input),n=document.getElementById(C.withdrawForm.cancelButton),a=document.getElementById(C.withdrawForm.withdrawButton),!(0<(o=Number(o.value))))return[3,5];t.label=1;case 1:return t.trys.push([1,3,4,5]),q=!0,n.classList.add("disabled"),a.innerHTML="Withdraw "+g(),i=M(o,i),[4,e.farm.methods.withdraw(i).send({from:r})];case 2:return t.sent().status&&p("Transaction confirmed!"),U(),L.dispatch("withdraw success"),[3,5];case 3:return r=t.sent(),console.error(r),"INVALID_ARGUMENT"==r.code?p("Placeholder cannot be empty"):p(r.message),[3,5];case 4:return q=!1,n.classList.remove("disabled"),a.innerHTML="Withdraw",[7];case 5:return[2]}})})})},j=function(){return o(void 0,void 0,void 0,function(){var e,n,a,o,i,r;return l(this,function(t){switch(t.label){case 0:return e=y.contracts,r=y.account,n=y.stakingTokenName,a=y.stakingDecimals,o=document.getElementById(C.widget.root),i=document.getElementById(C.withdrawForm.title),o.classList.add("farmfactory-withdraw-visible"),i.innerHTML="Balance: "+g(!0),[4,e.farm.methods.balanceOf(r).call()];case 1:return r=t.sent(),i.innerHTML="Balance: <b>"+T(Number(r)/Math.pow(10,a))+" "+n+"</b>",[2]}})})},G=!1,K='\n  <div class="farmfactory-root farmfactory-connect-visible" id="'+C.widget.root+'">\n    '+N+"\n    "+P+"\n    "+z+'\n    <div class="farmfactory-widget">\n      <div class="farmfactory-line">\n        <div class="farmfactory-row">\n          <div class="farmfactory-title">Earned</div>\n          <div class="farmfactory-buttons">\n            <button class="farmfactory-button disabled" id="'+C.widget.harvestButton+'">Harvest</button>\n          </div>\n        </div>\n        <div class="farmfactory-value" id="'+C.widget.earned+'">&mdash;</div>\n      </div>\n      <div class="farmfactory-line">\n        <div class="farmfactory-row">\n          <div class="farmfactory-title">Staked</div>\n          <div class="farmfactory-buttons" id="'+C.widget.lpsButtons+'"></div>\n        </div>\n        <div class="farmfactory-value" id="'+C.widget.staked+'">&mdash;</div>\n      </div>\n    </div>\n  </div>\n',J='\n  <button class="farmfactory-button" id="'+C.widget.approveButton+'">Approve</button>\n',Q='\n  <button class="farmfactory-button" id="'+C.widget.depositButton+'">Deposit</button>\n  <button class="farmfactory-button" id="'+C.widget.withdrawButton+'">Withdraw</button>\n',X=function(t){var e,n,a=document.getElementById(C.widget.lpsButtons);t?(a.innerHTML=Q,n=y.opts,t=document.getElementById(C.widget.depositButton),n.widget.depositButtonTitle&&(t.innerText=n.widget.depositButtonTitle),t.addEventListener("click",function(){_()}),t=y.opts,e=document.getElementById(C.widget.withdrawButton),t.widget.withdrawButtonTitle&&(e.innerText=t.widget.withdrawButtonTitle),e.addEventListener("click",function(){e.classList.contains("disabled")||j()})):(a.innerHTML=J,k())},Y=function(){document.getElementById(C.widgetRoot).innerHTML=K,R(),W(),V(),E(),L.subscribe("connect",B),L.subscribe("deposit success",B),L.subscribe("withdraw success",B)};return{init:function(i){return o(void 0,void 0,void 0,function(){var e,n,a,o;return l(this,function(t){if(!i)throw new Error("options required");if(e=i.widget||{},n=e.farmAddress,a=e.rewardsAddress,o=e.stakingAddress,!(e.networkName&&n&&a&&o))throw new Error("widgetOptions required");return r({opts:i}),"https:"!==location.protocol&&p("FarmFactory widget requires HTTPS connection."),o=F(),Y(),o.providerController.cachedProvider&&I(),[2]})})}}}();
